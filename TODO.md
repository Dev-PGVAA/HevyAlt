# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–û—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –∏ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞, –≤–æ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω:

## üìã –û–±–∑–æ—Ä —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏

–°–µ—Ä–≤–µ—Ä —É–∂–µ –≥–æ—Ç–æ–≤ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- **POST /auth/login** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç user + accessToken, refreshToken –≤ cookie)
- **POST /auth/register** - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç user + accessToken, refreshToken –≤ cookie)
- **POST /auth/login/access-token** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç refreshToken –∏–∑ cookie)
- **POST /auth/logout** - –≤—ã—Ö–æ–¥ (–æ—á–∏—â–∞–µ—Ç cookie)

## üéØ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### 1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

```yaml
dependencies:
  dio: ^5.4.0 # HTTP –∫–ª–∏–µ–Ω—Ç
  dio_cookie_manager: ^3.1.1 # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ cookies
  cookie_jar: ^4.0.8 # –•—Ä–∞–Ω–µ–Ω–∏–µ cookies
  flutter_secure_storage: ^9.0.0 # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
  provider: ^6.1.1 # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
```

### 2. **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö**

–°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª–∏ –≤ `lib/models/`:

- `user.dart` - –º–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `auth_response.dart` - –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `login_request.dart` - –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—Ö–æ–¥
- `register_request.dart` - –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é

### 3. **AuthService**

–°–æ–∑–¥–∞—Ç—å `lib/services/auth_service.dart` —Å –º–µ—Ç–æ–¥–∞–º–∏:

- `login(email, password)` - –≤—Ö–æ–¥
- `register(name, email, password)` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `refreshToken()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- `logout()` - –≤—ã—Ö–æ–¥
- `getCurrentUser()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `isAuthenticated()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 4. **AuthProvider**

–°–æ–∑–¥–∞—Ç—å `lib/providers/auth_provider.dart` –¥–ª—è:

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –•—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 5. **HTTP Interceptor**

–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Dio —Å –∏–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä–∞–º–∏ –¥–ª—è:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è accessToken –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∏ 401 –æ—à–∏–±–æ–∫ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è cookies

### 6. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI**

- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å AuthService –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–º—ã –ª–æ–≥–∏–Ω–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫
- –°–æ–∑–¥–∞—Ç—å AuthGuard –¥–ª—è –∑–∞—â–∏—Ç—ã —ç–∫—Ä–∞–Ω–æ–≤

### 7. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–∫—Ä–∞–Ω

### 8. **–ù–∞–≤–∏–≥–∞—Ü–∏—è**

- –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —ç–∫—Ä–∞–Ω–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- –ó–∞—â–∏—Ç–∞ —ç–∫—Ä–∞–Ω–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 9. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
- Graceful degradation –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

## üîÑ –ü–æ—Ç–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

1. **–í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** ‚Üí AuthService ‚Üí –°–µ—Ä–≤–µ—Ä
2. **–°–µ—Ä–≤–µ—Ä** ‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç user + accessToken + refreshToken (–≤ cookie)
3. **–ö–ª–∏–µ–Ω—Ç** ‚Üí –°–æ—Ö—Ä–∞–Ω—è–µ—Ç accessToken –≤ –ø–∞–º—è—Ç–∏, refreshToken –≤ secure storage
4. **API –∑–∞–ø—Ä–æ—Å—ã** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è accessToken –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
5. **–ü—Ä–∏ 401** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ refreshToken
6. **–í—ã—Ö–æ–¥** ‚Üí –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –∏ cookies
